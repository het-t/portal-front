"use strict";(self["webpackChunkportal"]=self["webpackChunkportal"]||[]).push([[609,978,433,884],{1435:function(e,t,o){o.d(t,{Z:function(){return m}});var s=o(6252),i=o(9963),r=o(3577);const n={class:"dots-parent"};function a(e,t,o,a,l,d){const c=(0,s.up)("font-awesome-icon"),u=(0,s.Q2)("click-away");return(0,s.wy)(((0,s.wg)(),(0,s.iD)("td",{onClick:t[0]||(t[0]=(0,i.iM)((e=>d.showDots(e)),["stop"])),class:"dots-parent p0"},[(0,s._)("div",n,[(0,s.Wm)(c,{class:(0,r.C_)([l.dotsVisibility,"dots-img"]),icon:["fas","ellipsis-vertical"]},null,8,["class"])])])),[[u,d.hide]])}var l=o(1535),d={name:"DotsImg",mixins:[l.jB],data(){return{dotsVisibility:""}},methods:{showDots(e){this.dotsVisibility="dots-clicked",this.$emit("openMenu",e)},hide(e){this.dotsVisibility="",this.$emit("hideMenu",e)}}},c=o(3744);const u=(0,c.Z)(d,[["render",a],["__scopeId","data-v-42ac310e"]]);var m=u},1936:function(e,t,o){o.d(t,{Z:function(){return u}});var s=o(6252),i=o(9963);const r={class:"dots-menu"};function n(e,t,o,n,a,l){return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("ul",{onClick:t[0]||(t[0]=(0,i.iM)((e=>!0),["stop"]))},[(0,s.WI)(e.$slots,"links")])])}var a=o(1535),l={name:"dotsMenu",data(){return{menu:""}},mixins:[a.jB]},d=o(3744);const c=(0,d.Z)(l,[["render",n]]);var u=c},5978:function(e,t,o){o.r(t),o.d(t,{default:function(){return l}});var s=o(6252);function i(e,t){return(0,s.wg)(),(0,s.iD)("div",null," you dont have access to this page ")}var r=o(3744);const n={},a=(0,r.Z)(n,[["render",i]]);var l=a},433:function(e,t,o){o.r(t),o.d(t,{default:function(){return R}});var s=o(6252),i=o(9963),r=o(3577);const n=e=>((0,s.dD)("data-v-07760fbe"),e=e(),(0,s.Cn)(),e),a={class:"card pr16 pl16 pb16"},l={class:"pr16 pl16 pt16 pb16"},d={class:"row mt8"},c={ref:"focus",for:"role-name",class:"labels c1"},u=n((()=>(0,s._)("div",{class:"hr"},null,-1))),m={class:"row mt8"},h=n((()=>(0,s._)("label",{class:"labels c1"},"rights",-1))),g=["id","value","name","title"],p=["for"],f=n((()=>(0,s._)("div",{class:"hr"},null,-1)));function v(e,t,o,n,v,b){return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("form",l,[(0,s._)("div",d,[(0,s._)("label",c,"name",512),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>v.roleName=e),type:"text",id:"role-name"},null,512),[[i.nr,v.roleName]])]),u,(0,s._)("div",m,[h,(0,s._)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(v.rightsList,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"mt16 flex",key:e},[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>v.roleRights=e),id:e.id,value:e.id,class:"m0 mr16",type:"checkbox",name:e.name,title:e?.description},null,8,g),[[i.e8,v.roleRights]]),(0,s._)("label",{for:e.id},(0,r.zw)(e.name),9,p)])))),128))])]),f,(0,s._)("button",{onClick:t[2]||(t[2]=(0,i.iM)((e=>void 0==o.editRoleId||""==o.editRoleId?b.createRole({roleName:v.roleName,roleRights:v.roleRights}):b.editRole()),["prevent"])),class:"green button"},"save"),(0,s._)("button",{onClick:t[3]||(t[3]=(0,i.iM)((e=>b.canceled()),["prevent"])),class:"neutral ml8 button"},"cancel")])])}var b=o(9235),_=o(3262),w=o(6737),y=o.n(w),k=o(4802),C={name:"CreateRole",props:["editRoleId","uk"],data(){return{roleName:"",roleRights:[],rightsList:[]}},methods:{createRole({roleName:e,roleRights:t}){(0,_.Z)({text:e,mutationFnName:"roles/RESET_STATE",promise:()=>b.uJ.create({roleName:e,roleRights:t}),context:this,url:"/u/roles/list"})},editRole(){const e={roleId:this.editRoleId,roleName:this.roleName,roleRights:this.roleRights};(0,k.Z)({text:e.roleName,promise:()=>b.uJ.edit(e),mutationFnName:"roles/RESET_STATE",context:this})},canceled(){y()({title:"Do you really want to cancel editing?",text:"All changes will be reverted",icon:"warning",buttons:!0,dangerMode:!0}).then((e=>{if(null!=e)throw null})).catch((()=>{1==this.editing?this.$emit("editingCompleted",{editing:0,role:this.roleName}):this.$router.push("/u/roles/list")}))}},created(){this.rightsList=this.$store.getters["rights/getAllRightsList"];const e=this.$store.getters["roles/rolesDataGet"](this.editRoleId);console.log("editing",e),void 0!=e&&""!=e&&(console.log("coming inside",e),this.roleName=e[0].roleName,this.roleRights=e.map((e=>e.rightId)))},mounted(){this.$refs["focus"].focus()}},N=o(3744);const $=(0,N.Z)(C,[["render",v],["__scopeId","data-v-07760fbe"]]);var R=$},4609:function(e,t,o){o.r(t),o.d(t,{default:function(){return Z}});var s=o(6252),i=o(9963),r=o(3577);const n=e=>((0,s.dD)("data-v-3fb9a6af"),e=e(),(0,s.Cn)(),e),a={ref:"menu"},l={class:"card"},d={class:"mr16 ml16 mt16"},c={class:"flex"},u={class:"floating-container"},m={class:"flex"},h={class:"floating-container"},g=n((()=>(0,s._)("th",null,null,-1))),p=["onKeyup","onClick"],f={colspan:"2",class:"p0 m0"};function v(e,t,o,n,v,b){const _=(0,s.up)("font-awesome-icon"),w=(0,s.up)("router-link"),y=(0,s.up)("dots-menu"),k=(0,s.up)("table-sort"),C=(0,s.up)("DotsImg"),N=(0,s.up)("skeleton-form"),$=(0,s.up)("TablePagination"),R=(0,s.Q2)("debounce");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",a,[1==v.menuVisibisility?((0,s.wg)(),(0,s.j4)(y,{key:0},{links:(0,s.w5)((()=>[(0,s._)("li",null,[(0,s.Wm)(w,{to:{name:"edit_role",params:{editRoleId:v.editRoleId}}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{class:"menu-icons",icon:["fas","pencil"]})])),_:1},8,["to"])]),(0,s._)("li",null,[(0,s.Wm)(_,{onClick:t[0]||(t[0]=t=>b.deleteRole(v.editRoleId,e.editRoleName)),class:"menu-icons",icon:["fas","trash"]})])])),_:1})):(0,s.kq)("",!0)],512),(0,s._)("div",l,[(0,s._)("div",d,[(0,s._)("table",null,[(0,s._)("tr",null,[(0,s._)("th",null,[(0,s._)("div",c,[((0,s.wg)(),(0,s.j4)(k,{key:v.i,onClicked:t[1]||(t[1]=e=>{v.j=!v.j,v.p=!v.p}),sortType:"string",sortBy:"name",storeName:"roles"})),(0,s._)("div",u,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>v.filterFor[0]=e),ref:"nameH",class:"header p0",type:"text",required:""},null,512),[[R,b.sort,"700ms",{lock:!0}],[i.nr,v.filterFor[0]]]),(0,s._)("span",{onClick:t[3]||(t[3]=t=>e.$refs["nameH"].focus()),class:"floating-label"},"name")])])]),(0,s._)("th",null,[(0,s._)("div",m,[((0,s.wg)(),(0,s.j4)(k,{key:v.j,onClicked:t[4]||(t[4]=e=>{v.i,v.i,v.p=!v.p}),sortType:"number",sortBy:"rights",storeName:"roles"})),(0,s._)("div",h,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>v.filterFor[1]=e),ref:"rightsH",type:"text",class:"header p0",required:""},null,512),[[R,b.sort,"700ms",{lock:!0}],[i.nr,v.filterFor[1]]]),(0,s._)("span",{onClick:t[6]||(t[6]=t=>e.$refs["rightsH"].focus()),class:"floating-label"},"rights")])])]),g]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(v.rolesList,((e,t)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:e.id},[(0,s._)("tr",{class:"tr edit-role-tr",tabindex:"0",onKeyup:(0,i.D2)((o=>b.editRole("row"+t,e.id)),["enter"]),onClick:(0,i.iM)((o=>b.editRole("row"+t,e.id)),["prevent"])},[(0,s._)("td",null,(0,r.zw)(e?.name),1),(0,s._)("td",null,(0,r.zw)(e?.rights),1),(0,s.Wm)(C,{onOpenMenu:t=>b.menu(t,{roleName:e.name,roleId:e.id,visibility:!0}),onHideMenu:t=>b.menu(t,{roleName:e.name,roleId:e.id,visibility:!1})},null,8,["onOpenMenu","onHideMenu"])],40,p),(0,s._)("tr",{class:"tr tr-hidden hide",ref_for:!0,ref:"row"+t},[(0,s._)("td",f,[v.componentId?.[e.id]?((0,s.wg)(),(0,s.j4)((0,s.LL)(v.componentId?.[e.id]),{key:0,editRoleId:e.id,uk:t,buttonsIndex:1,onEditingCompleted:o=>b.editRole("row"+t,e.id)},null,40,["editRoleId","uk","onEditingCompleted"])):((0,s.wg)(),(0,s.j4)(N,{key:1,buttonsIndex:2}))])],512)],64)))),128))]),((0,s.wg)(),(0,s.j4)($,{onTableData:t[7]||(t[7]=e=>v.rolesList=e),key:v.p,filters:v.filterFor,tableName:"roles"},null,8,["filters"]))])])])}var b=o(9235),_=o(1936),w=o(1435),y=o(5884),k=o(1049),C=o(433),N=o(665),$=o(7359),R=o(5978),D=o(4814),I={name:"EditRoleList",data(){return{menuVisibisility:"",rolesList:[],editRoleId:"",i:0,j:0,p:0,filterFor:["",""],componentId:{}}},methods:{editRole(e,t){console.log(e,t);const o=this.$refs[e][0].classList.contains("hide");1==o?this.$refs[e][0].classList.remove("hide"):this.$refs[e][0].classList.add("hide"),(0,N.Z)("edit_role")&&(this.componentId[t]="SkeletonForm",this.$store.dispatch("roles/rolesDataSet",{roleId:t}).then((()=>this.componentId[t]="RoleCreate")))},deleteRole(e,t){(0,D.Z)({text:t,promise:()=>b.uJ["delete"]({roleId:e}),context:this,mutationFn:"roles/deleteRole",mutationArgs:{roleId:e,filters:this.filterFor}})},menu(e,{roleName:t,roleId:o,visibility:s}){this.menuVisibisility=s,this.editRoleId=o,this.editRoleName=t,1==s&&e.target.parentElement.appendChild(this.$refs["menu"])},sort(){console.log("sorting",this.filterFor),this.p=!this.p}},components:{TablePagination:y["default"],DotsMenu:_.Z,DotsImg:w.Z,TableSort:k.Z,RoleCreate:C["default"],SkeletonForm:$.Z,NoAccess:R["default"]}},P=o(3744);const x=(0,P.Z)(I,[["render",v],["__scopeId","data-v-3fb9a6af"]]);var Z=x},5884:function(e,t,o){o.r(t),o.d(t,{default:function(){return N}});var s=o(6252),i=o(9963),r=o(3577);const n=e=>((0,s.dD)("data-v-a142ede8"),e=e(),(0,s.Cn)(),e),a={class:"flex"},l={class:"recordsPerPage"},d=n((()=>(0,s._)("label",{for:"recordsPerPage"},"entries",-1))),c=n((()=>(0,s._)("option",{value:10},"10",-1))),u=n((()=>(0,s._)("option",{value:20},"20",-1))),m=n((()=>(0,s._)("option",{value:50},"50",-1))),h=n((()=>(0,s._)("option",{value:100},"100",-1))),g=[c,u,m,h],p={class:"neutral"},f=["onClick"],v={class:"neutral"};function b(e,t,o,n,c,u){return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",l,[d,(0,s.wy)((0,s._)("select",{onChange:t[0]||(t[0]=e=>u.getPageData()),id:"recordsPerPage","onUpdate:modelValue":t[1]||(t[1]=e=>c.recordsPerPage=e),class:"ml8"},g,544),[[i.bM,c.recordsPerPage]])]),(0,s._)("ul",null,[(0,s._)("li",p,[(0,s._)("a",{href:"#",onClick:t[2]||(t[2]=e=>u.pageChange(1))},"<")]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.showPage(),(e=>((0,s.wg)(),(0,s.iD)("li",{class:"neutral",key:e},[(0,s._)("a",{href:"#",class:(0,r.C_)(e==c.currentPage?"green":""),onClick:t=>u.pageChange(e)},(0,r.zw)(e),11,f)])))),128)),(0,s._)("li",v,[(0,s._)("a",{href:"#",onClick:t[3]||(t[3]=e=>u.pageChange(c.pageCount))},">")])])])}var _=o(9669),w=o.n(_),y={name:"TablePagination",data(){return{pageData:"",currentPage:1,recordsPerPage:10,pageCount:""}},computed:{totalRecords(){return this.$store.getters[`${this.tableName}/${this.tableName}CountGet`]}},props:{tableName:String,sortBy:String,sortOrder:Number,filters:Array},methods:{showPage(){if(isNaN(this.pageCount))return 0;{let e=5;e=Math.min(e,this.pageCount);let t=this.currentPage-Math.floor(e/2);return t=Math.max(t,1),t=Math.min(t,this.pageCount-e+1),[...Array(e)].map(((e,o)=>o+t))}},pageChange(e){this.currentPage=e,this.$store.commit(`${this.tableName}/currentPageSet`,{index:e}),this.getPageData()},getPageData(){this.pageCount=Math.ceil(this.totalRecords/this.recordsPerPage);const{sortBy:e,sortOrder:t}=this.$store.getters[`${this.tableName}/sortGet`];let o=this.$store.getters[`${this.tableName}/${this.tableName}ListGet`]?.(this.currentPage,e,t,this.filters);void 0==o||0==o?.length||o?.length<this.recordsPerPage&&o?.length>=10?w().get(`/u/api/${this.tableName}`,{params:{from:(this.currentPage-1)*this.recordsPerPage,recordsPerPage:this.recordsPerPage,sortBy:e,sortOrder:t,filters:this.filters},withCredentials:!0}).then((o=>{this.$store.commit(`${this.tableName}/${this.tableName}List`,{index:this.currentPage,sortBy:e,sortOrder:t,filters:this.filters,data:o.data[this.tableName+"List"]}),this.$emit("tableData",o.data[this.tableName+"List"])})):this.$emit("tableData",o)}},created(){this.$store.commit(`${this.tableName}/currentPageSet`,{index:this.currentPage}),""==this.totalRecords?w().get(`/u/api/${this.tableName}/count`,{withCredentials:!0}).then((e=>{this.$store.commit(`${this.tableName}/${this.tableName}CountSet`,e?.data?.count),this.getPageData()})):this.getPageData()}},k=o(3744);const C=(0,k.Z)(y,[["render",b],["__scopeId","data-v-a142ede8"]]);var N=C},1049:function(e,t,o){o.d(t,{Z:function(){return d}});var s=o(6252),i=o(9963);function r(e,t,o,r,n,a){const l=(0,s.up)("font-awesome-icon");return(0,s.wg)(),(0,s.iD)("div",{class:"sort mr8",onClick:t[0]||(t[0]=(...e)=>a.rotateImg&&a.rotateImg(...e)),onKeyup:t[1]||(t[1]=(0,i.D2)(((...e)=>a.rotateImg&&a.rotateImg(...e)),["enter"]))},["string"==o.sortType?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[1==n.sortOrder?((0,s.wg)(),(0,s.j4)(l,{key:0,class:"sort-btn",icon:"fa-solid fa-arrow-down-a-z"})):((0,s.wg)(),(0,s.j4)(l,{key:1,class:"sort-btn",icon:"fa-solid fa-arrow-up-a-z"}))],64)):"number"==o.sortType?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[1==n.sortOrder?((0,s.wg)(),(0,s.j4)(l,{key:0,class:"sort-btn",icon:"fa-solid fa-arrow-down-1-9"})):((0,s.wg)(),(0,s.j4)(l,{key:1,class:"sort-btn",icon:"fa-solid fa-arrow-up-1-9"}))],64)):(0,s.kq)("",!0)],32)}var n={name:"TableSort",props:["sortBy","storeName","sortType"],data(){return{sortOrder:0}},methods:{rotateImg(){1===this.sortOrder?this.sortOrder=0:this.sortOrder=1,this.$emit("clicked"),this.$store.commit(`${this.storeName}/sortSet`,{sortBy:this.sortBy,sortOrder:this.sortOrder})}},updated(){console.log("updated")}},a=o(3744);const l=(0,a.Z)(n,[["render",r],["__scopeId","data-v-8a032ec6"]]);var d=l},7359:function(e,t,o){o.d(t,{Z:function(){return v}});var s=o(6252);const i=e=>((0,s.dD)("data-v-2c9935b4"),e=e(),(0,s.Cn)(),e),r={class:"card"},n={class:"table-tabs"},a={class:"mt16 pb16 pr16 pl16"},l={class:"pl16 pb16"},d={class:"fg"},c=i((()=>(0,s._)("label",{class:"skeleton labels c1"},null,-1))),u=i((()=>(0,s._)("label",{class:"skeleton input ml16"},null,-1))),m=[c,u];function h(e,t,o,i,c,u){return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",n,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.buttonsIndex,(e=>((0,s.wg)(),(0,s.iD)("button",{key:e,class:"skeleton button neutral tab"},".")))),128))]),(0,s._)("div",null,[(0,s._)("form",a,[(0,s._)("div",l,[(0,s._)("div",d,[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(5,(e=>(0,s._)("div",{key:e,class:"row mt8"},m))),64))])])])])])}var g={name:"SkeletonForm",props:{buttonsIndex:Number}},p=o(3744);const f=(0,p.Z)(g,[["render",h],["__scopeId","data-v-2c9935b4"]]);var v=f},1535:function(e,t,o){o.d(t,{jB:function(){return d}});const s=function(){return null!==document.ontouchstart?"click":"touchstart"},i="__vue_click_away__",r=function(e,t,o){n(e);let r=o.context,a=t.value,l=!1;setTimeout((function(){l=!0}),0),e[i]=function(t){if((!e||!e.contains(t.target))&&a&&l&&"function"===typeof a)return a.call(r,t)},document.addEventListener(s(),e[i],!1)},n=function(e){document.removeEventListener(s(),e[i],!1),delete e[i]},a=function(e,t,o){t.value!==t.oldValue&&r(e,t,o)},l={mounted:r,updated:a,unmounted:n},d={directives:{ClickAway:l}}},665:function(e,t,o){o.d(t,{Z:function(){return i}});var s=o(4907);function i(e){const t=s.Z.getters["rights/getUserRights"],o=t?.some((t=>t.code_name==e));return o}},3262:function(e,t,o){o.d(t,{Z:function(){return r}});var s=o(6737),i=o.n(s);function r({text:e,url:t,mutationFnName:o,mutationArgs:s,promise:r,context:n}){r().then((()=>i()({title:"Success",text:`Created "${e}"`,icon:"success",button:"ok"}))).then((()=>{n.$store.commit(o,s),setTimeout((()=>n.$router.push(t)),1)})).catch((e=>{null!=e&&i()("Oops!",`We can't perform this action right now please try again\n\n details: ${e}`)}))}},4814:function(e,t,o){o.d(t,{Z:function(){return n}});var s=o(4907),i=o(6737),r=o.n(i);function n({text:e,mutationFn:t,mutationArgs:o,promise:i}){r()({icon:"warning",title:"Alert",text:`Do you really want to delete "${e}"`,buttons:!0,dangerMode:!0}).then((e=>{if(null==e)throw null;return i()})).then((()=>(s.Z.commit(t,o),r()({title:"Success",text:`Deleted "${e}"`,icon:"success",button:"ok"})))).catch((e=>{if(null!=e)return r()("Oops!",`We can't perform this action right now please try again\n\n details: ${e}`)}))}}}]);
//# sourceMappingURL=609.7bbb6bb2.js.map